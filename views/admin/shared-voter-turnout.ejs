

<div class="first-main">
  <div class="main-content">
    <br />
    <br />
    <div class="left-container">
      <h1 class="ssc">Supreme Student Council</h1>
      <br />
      <div class="main-left">
        <h1>Total Voter Turnout</h1>
        <div class="content-box-2">
          <br />
          <canvas id="chart-turnout"></canvas>
          <div class="summary-text">
            <span></span>
          </div>
        </div>
        <h3 style="text-align: center;"><%= electionConfig.totalRegisteredVoted %> students have voted out of <%= electionConfig.totalNumberOfStudents %> students.</h3>
        <br />
        <div class="content-colleges"></div>
      </div>
    </div>
    <div class="right-container">
       
      <h1 class="lsc">Local Student Council</h1>
      <br />
      <div class="campus">
        <select class="select">
          <option>Main Campus</option>
          <!-- <option>External Campuses</option> -->
        </select>
      </div>
      <br />
      <div class="main-right">
        <h1>Voter Turnout per College</h1>
        <br />
        <div id="container-charts"></div>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      // Get the container where the liner bars will be rendered.
      const container = document.getElementById("container-charts");
      if (!container) return;

      // Retrieve the list of colleges from electionConfig (new structure)
      const colleges = <%- JSON.stringify(electionConfig.colleges) %>;
      console.log("Colleges data:", colleges);

      // Loop through each college and create a liner bar.
      colleges.forEach((college) => {
        const div = document.createElement("div");
        div.id = `liner-bar-college-${college.acronym}`;
        div.classList.add("liner-bar-college");
        container.appendChild(div);

        // For each college, the "Voted" value is the registeredVoted,
        // and "Not Yet Voted" is the remaining students.
        const data = {
          title: college.name,
          dark: false,
          items: [
            { name: "Voted", value: college.registeredVoted, color: "#5fb643" },
            { 
              name: "Not Yet Voted", 
              value: college.notRegisteredNotVoted + college.registeredNotVoted, 
              color: "#FC440F" 
            }
          ]
        };

        // Instantiate the liner bar using your LinerBar class from liner-bar.js.
        const bar = new LinerBar(`#${div.id}`, data);
        bar.render();
      });
    });
  </script>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      // Retrieve the list of colleges from electionConfig (new structure)
      const colleges = <%- JSON.stringify(electionConfig.colleges) %>;

      // Compute overall totals
      let totalStudents = 0;
      let totalRegisteredNotVoted = 0;
      let totalRegisteredVoted = 0;
      let totalNotRegisteredNotVoted = 0;
      
      colleges.forEach(college => {
        totalStudents += college.numberOfStudents;
        totalRegisteredNotVoted += college.registeredNotVoted;
        totalRegisteredVoted += college.registeredVoted;
        totalNotRegisteredNotVoted += college.notRegisteredNotVoted;
      });
      
      // For the overall pie chart:
      // "Voted" is the sum of registeredVoted,
      // "Not Yet Voted" is the sum of (registeredNotVoted + notRegisteredNotVoted)
      const totalNotVoted = totalRegisteredNotVoted + totalNotRegisteredNotVoted;

      // Setup Chart.js chart data
      const ctx = document.getElementById('chart-turnout').getContext('2d');
      const data = {
        labels: ['Voted', 'Not Yet Voted'],
        datasets: [{
          data: [totalRegisteredVoted, totalNotRegisteredNotVoted + totalRegisteredNotVoted ],
          backgroundColor: ['#5fb643', '#FC440F'],
          borderWidth: 1,
        }]
      };

      // Instantiate the pie chart using Chart.js
      new Chart(ctx, {
        type: 'pie', // or 'doughnut' if preferred
        data: data,
        options: {
          responsive: true,
          plugins: {
            legend: {
              position: 'bottom'
            },
            title: {
              display: true,
              text: 'BulSU Total Voter Turnout'
            }
          }
        }
      });
    });
  </script>

  
</div>
