<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Voting System</title>
    <link rel="stylesheet" type="text/css" href="css/index.css" />
    <link rel="stylesheet" type="text/css" href="voter/css/index-voter.css" />
    <link rel="stylesheet" type="text/css" href="voter/css/vote.css" />
    <link rel="stylesheet" type="text/css" href="voter/css/review.css" />

    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Poppins:wght@400;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />

    <style>
      .loading-bar {
        width: 0;
        height: 5px;
        background-color: #4caf50;
        margin-top: 10px;
        transition: width 10s linear;
      }
    </style>
  </head>

  <body>
    <header class="header">
      <div class="header-logo">
        <img src="img/logo_tanikala.png" alt="Tanikala Voting System" />
      </div>
      <nav class="header-nav">
        <ul class="header-nav-content">
          <li>Vote</li>
          <p>|</p>
          <li id="active-link">Review</li>
          <p>|</p>
          <li>Verify</li>
          <div class="settings">
            <i class="fa-solid fa-user"></i>

            <div class="dropdown" onclick="toggleDropdownVoter()"></div>
            <div class="dropdown-menu">
              <p>
                Logged in as <br />
                <strong><%= email %></strong>
              </p>
              <hr class="dropdown-line" />
              <a href="/voter/logout">Log Out</a>
            </div>
          </div>
        </ul>
      </nav>

      <div class="header-bottom-line"></div>
    </header>

    <div class="content">
      <div class="main-first">
        <img src="img/logo_bulsu.png" class="main-first-logo" alt="BulSU Logo" />
        <div class="first-text">
          <h2 class="title"><%= electionConfig.electionName %></h2>
        </div>
        <img src="img/logo_bulsu_ucse.png" class="main-first-logo" alt="BulSU UCSE Logo" />
      </div>

      <div class="content-main">
        <p><i>Please REVIEW your votes before SUBMITTING BALLOT to the Blockchain.</i></p>
        <br />
        <div class="review">
          <br />

          <h3 class="ballot-header ballot-summary">VOTE SUMMARY</h3>
          <br />
          <h3 class="ballot-header ballot-council">BulSU Supreme Student Council</h3>

          <div class="ssc-row">
             <!-- Review Vote Card Markup for President -->
<div class="review-vote-card">
  <!-- Display the position at the top -->
  <h1><%= president.position %></h1>

  <div class="ballot-choices">
    <div class="label-container label-president">
      <input 
        class="ballot-choice candidate-radio" 
        data-group="president" 
        id="president-selected" 
        type="radio" 
        name="president" 
        value="<%= JSON.stringify(president) %>" 
        checked 
        disabled 
      />
      <label class="ballot-tile label-president" for="president-selected">
        <!-- Party Name -->
        <h4 class="party"><%= president.party %></h4>
        <!-- Candidate Image -->
        <img class="img-president" src="<%= president.image %>" alt="<%= president.name %>" />
        <!-- Candidate Name -->
        <h4 class="name"><%= president.name %></h4>
        <hr />
        <!-- Additional Candidate Info -->
        <p class="info"><%= president.moreInfo %></p>
      </label>
    </div>
  </div>
</div>
            
<!-- Review Vote Card Markup for Vice President -->
<div class="review-vote-card">
  <!-- Display the position at the top -->
  <h1><%= vicePresident.position %></h1>

  <div class="ballot-choices">
    <div class="label-container label-vice-president">
      <input 
        class="ballot-choice candidate-radio" 
        data-group="vicePresident" 
        id="vicePresident-selected" 
        type="radio" 
        name="vicePresident" 
        value="<%= JSON.stringify(vicePresident) %>" 
        checked 
        disabled 
      />
      <label class="ballot-tile label-vice-president" for="vicePresident-selected">
        <!-- Party Name -->
        <h4 class="party"><%= vicePresident.party %></h4>
        <!-- Candidate Image -->
        <img class="img-vice-president" src="<%= vicePresident.image %>" alt="<%= vicePresident.name %>" />
        <!-- Candidate Name -->
        <h4 class="name"><%= vicePresident.name %></h4>
        <hr />
        <!-- Additional Candidate Info -->
        <p class="info"><%= vicePresident.moreInfo %></p>
      </label>
    </div>
  </div>
</div>
</div>
            
            
            <l  i>
              <div class="senator-cards">
                <% if (Array.isArray(senator)) { %> <% senator.forEach(function(senatorCandidate) { %>
                <div class="card">
                  <div class="smallIcon">
                    <div class="Icon">
                      <img src="<%= senatorCandidate.image %>" alt="<%= senatorCandidate.name %>" />
                    </div>
                    <div class="Name">
                      <h2><%= senatorCandidate.name %></h2>
                    </div>
                    <div class="Roles">
                      <h2><%= senatorCandidate.position %></h2>
                    </div>
                    <div class="Description">
                      <p><%= senatorCandidate.moreInfo %></p>
                    </div>
                  </div>
                </div>
                <br />
                <% }); %> <% } else { %>
                <div class="card">
                  <div class="smallIcon">
                    <div class="Icon">
                      <img src="<%= senator.image %>" alt="<%= senator.name %>" />
                    </div>
                    <div class="Name">
                      <h2><%= senator.name %></h2>
                    </div>
                    <div class="Roles">
                      <h2><%= senator.position %></h2>
                    </div>
                    <div class="Description">
                      <p><%= senator.moreInfo %></p>
                    </div>
                  </div>
                </div>

                <% } %>
              </div>
            </li>
          </ul>

          <h3 class="ballot-header ballot-lsc-council">BulSU Local Student Council - <%= college %></h3>

          <ul>
            <li>
              <div class="card">
                <div class="smallIcon">
                  <div class="Icon">
                    <img src="<%= governor.image %>" alt="<%= governor.name %>" />
                  </div>
                  <div class="Name">
                    <h2><%= governor.name %></h2>
                  </div>
                  <div class="Roles">
                    <h2><%= governor.position %></h2>
                  </div>
                  <div class="Description">
                    <p><%= governor.moreInfo %></p>
                  </div>
                </div>
              </div>
            </li>
            <br />
            <li>
              <div class="card">
                <div class="smallIcon">
                  <div class="Icon">
                    <img src="<%= viceGovernor.image %>" alt="<%= viceGovernor.name %>" />
                  </div>
                  <div class="Name">
                    <h2><%= viceGovernor.name %></h2>
                  </div>
                  <div class="Roles">
                    <h2><%= viceGovernor.position %></h2>
                  </div>
                  <div class="Description">
                    <p><%= viceGovernor.moreInfo %></p>
                  </div>
                </div>
              </div>
            </li>
            <br />
            <li>
              <div class="card">
                <div class="smallIcon">
                  <div class="Icon">
                    <img src="<%= boardMember.image %>" alt="<%= boardMember.name %>" />
                  </div>
                  <div class="Name">
                    <h2><%= boardMember.name %></h2>
                  </div>
                  <div class="Roles">
                    <h2><%= boardMember.position %></h2>
                  </div>
                  <div class="Description">
                    <p><%= boardMember.moreInfo %></p>
                  </div>
                </div>
              </div>
            </li>
            <br />
          </ul>

          <form id="voteForm" action="/submit-votes-to-blockchain" method="POST">
            <!-- Hidden inputs for each candidate object -->
            <input type="hidden" name="president" value="<%= JSON.stringify(president) %>" />
            <input type="hidden" name="vicePresident" value="<%= JSON.stringify(vicePresident) %>" />
            <input type="hidden" name="senator" value="<%= JSON.stringify(senator) %>" />
            <input type="hidden" name="governor" value="<%= JSON.stringify(governor) %>" />
            <input type="hidden" name="viceGovernor" value="<%= JSON.stringify(viceGovernor) %>" />
            <input type="hidden" name="boardMember" value="<%= JSON.stringify(boardMember) %>" />
            <input type="hidden" name="college" value="<%= college %>" />
            <input type="hidden" name="program" value="<%= program %>" />
            <input type="hidden" name="email" value="<%= email %>" />
            <br />
            <!-- Submit button -->
            <div class="button-container">
              <button class="button-back" type="button" onclick="window.history.back()">
                <svg fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 12H4.5m0 0l6.75-6.75M4.5 12l6.75 6.75"></path>
                </svg>
                <div class="text">Go Back</div>
              </button>

              <input type="hidden" id="voteData" value="Vote data placeholder" />
              <button type="submit" id="submitBtn" value="Submit Votes to Blockchain" onclick="" class="button">
                <span class="fold"></span>

                <div class="points_wrapper">
                  <i class="point"></i>
                  <i class="point"></i>
                  <i class="point"></i>
                  <i class="point"></i>
                  <i class="point"></i>
                  <i class="point"></i>
                  <i class="point"></i>
                  <i class="point"></i>
                  <i class="point"></i>
                  <i class="point"></i>
                </div>

                <span class="inner">
                  <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5">
                    <polyline points="13.18 1.37 13.18 9.64 21.45 9.64 10.82 22.63 10.82 14.36 2.55 14.36 13.18 1.37"></polyline>
                  </svg>
                  <span>Submit Votes to Blockchain</span>
                </span>
              </button>
            </div>

            <!-- Loading bar as a block element -->
            <div id="loadingBar" class="loading-bar"></div>
            <!-- <hr class="review-line" />
            <p class="review"><i>You still need to review and confirm your votes in the next page.</i></p>
            <hr class="review-line" /> -->
          </form>

          <script>
            document.getElementById("voteForm").addEventListener("submit", function () {
              document.getElementById("loadingBar").style.width = "100%";
            });
          </script>

          <br /><br />
        </div>

        <input type="hidden" name="college" value="<%= college %>" />
        <input type="hidden" name="program" value="<%= program %>" />
        <input type="hidden" name="email" value="<%= email %>" />
      </div>
    </div>

    <footer class="footer">
      <div class="footer-left">
        <img src="img/calendar.png" class="footer-img" />
        <p id="datetime" data-date="<%= electionConfig.fakeCurrentDate %>"></p>
      </div>

      <div class="footer-center">
        <img src="img/copyright.png" class="footer-img" id="copyright-img" />
        <p>2025 - Fourmula 1</p>
      </div>
      <div class="footer-right"></div>
    </footer>
    <script src="js/index.js"></script>

    <script>
      function formatDate(isoString) {
        const date = new Date(isoString);
        const options = {
          month: "long",
          day: "2-digit",
          year: "numeric",
          hour: "2-digit",
          minute: "2-digit",
          hour12: true,
        };
        return date.toLocaleString("en-US", options).toUpperCase();
      }

      function updateDateTime() {
        const datetimeElement = document.getElementById("datetime");
        if (!datetimeElement) return;

        // Get the initial time from the data attribute
        let currentTime = new Date(datetimeElement.getAttribute("data-date"));

        function update() {
          datetimeElement.textContent = formatDate(currentTime);
          currentTime.setMinutes(currentTime.getMinutes() + 1); // Increment by 1 minute
        }

        update(); // Set initial formatted date
        setInterval(update, 60000); // Update every minute (60000ms)
      }

      document.addEventListener("DOMContentLoaded", updateDateTime);
    </script>
    <script src="js/dropdown.js"></script>
  </body>
</html>
